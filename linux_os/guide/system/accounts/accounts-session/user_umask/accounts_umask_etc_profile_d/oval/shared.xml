<def-group>
  <definition class="compliance" id="accounts_umask_etc_profile_d" version="2">
    <metadata>
      <title>Ensure that Users Have Sensible Umask Values in /etc/profile.d/*.sh</title>
      <affected family="unix">
        <platform>multi_platform_rhel</platform>
        <platform>multi_platform_sle</platform>
        <platform>multi_platform_wrlinux</platform>
      </affected>
      <description>The default umask for all users should be set correctly</description>
    </metadata>
    <criteria operator="AND">
      <criterion test_ref="tst_accounts_umask_etc_profile_d" />
    </criteria>
  </definition>

  <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="test" id="tst_accounts_umask_etc_profile_d" version="2">
    <ind:object object_ref="obj_accounts_umask_etc_profile_d" />
  </ind:textfilecontent54_test>

  <ind:textfilecontent54_object id="obj_accounts_umask_etc_profile_d"
  comment="Umask value from /etc/profile.d/*.sh" version="1">
    <ind:behaviors recurse="directories" recurse_direction="down" max_depth="-1" recurse_file_system="local" />
    <ind:path operation="equals">/etc/profile.d</ind:path>
    <ind:filename operation="pattern match">^.*\.sh$</ind:filename>
    <ind:pattern operation="pattern match">^[\s]*umask[\s]+(?!027)</ind:pattern>
    <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
  </ind:textfilecontent54_object>

</def-group>
