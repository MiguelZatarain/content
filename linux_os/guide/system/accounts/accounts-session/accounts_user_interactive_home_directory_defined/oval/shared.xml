<def-group oval_version="5.11">
  <definition class="compliance" id="accounts_user_interactive_home_directory_defined" version="1">
    <metadata>
      <title>Confirm Existence and Permissions of System Log Files</title>
      <affected family="unix">
        <platform>multi_platform_debian</platform>
        <platform>multi_platform_fedora</platform>
        <platform>multi_platform_ol</platform>
        <platform>multi_platform_rhel</platform>
        <platform>multi_platform_sle</platform>
        <platform>multi_platform_ubuntu</platform>
      </affected>
      <description>File permissions for all syslog log files should be set correctly.</description>
    </metadata>

    <criteria>
      <criterion comment="Check permissions of all system log files" test_ref="test_patatan" />
    </criteria>

  </definition>

  <!-- OVAL object to collect content of /etc/passwd file -->
  <ind:textfilecontent54_object id="object_accounts_user_interactive_home_directory_defined_etc_passwd_content" version="1">
    <ind:filepath>/etc/passwd</ind:filepath>
    <!-- Home paths from /etc/passwd (6-th column) captured as subexpression of this object -->
    <ind:pattern operation="pattern match">^.*:[1-9]\d{3,}:[0-9]+:[A-Za-z\s]+:([^:]+):.*$</ind:pattern>
    <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
  </ind:textfilecontent54_object>

  <!-- Turn that glob value into Perl's regex so it can be used as filepath pattern below -->
  <local_variable id="var_accounts_user_interactive_home_directory_defined_rfp_include_config_regex" datatype="string" version="1" comment="$IncludeConfig value converted to regex">
    <glob_to_regex>
      <object_component item_field="subexpression" object_ref="object_accounts_user_interactive_home_directory_defined_etc_passwd_content" />
    </glob_to_regex>
  </local_variable>

  <unix:file_object id="object_accounts_user_interactive_home_directory_defined_rfp_log_files_paths" comment="All rsyslog configuration files" version="1">
    <unix:path operation="pattern match" var_ref="var_accounts_user_interactive_home_directory_defined_rfp_include_config_regex" var_check="at least one" />
    <unix:filename xsi:nil="true" />
  </unix:file_object>

  <unix:file_test check="all" check_existence="at_least_one_exists" comment="/var/log/audit files mode 0600" id="test_accounts_user_interactive_home_directory_defined" version="1">
    <unix:object object_ref="object_accounts_user_interactive_home_directory_defined_rfp_log_files_paths" />
  </unix:file_test>

  <!-- OVAL object to collect content of /etc/passwd file -->
  <ind:textfilecontent54_object id="object_patatin" version="1">
    <ind:filepath>/home/poseso</ind:filepath>
    <!-- Home paths from /etc/passwd (6-th column) captured as subexpression of this object -->
    <ind:pattern operation="pattern match" var_ref="var_accounts_user_interactive_home_directory_defined_rfp_include_config_regex" var_check="at least one" />
    <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
  </ind:textfilecontent54_object>

  <ind:textfilecontent54_test check="all" comment="disk error action" id="test_patatan" version="1">
    <ind:object object_ref="object_patatin" />
  </ind:textfilecontent54_test>

</def-group>
